import{n as K,r as u,j as e,x as O}from"./main-Cj5NYhJq.js";import{u as $}from"./useQuery-Dpd-_BN-.js";import{u as h}from"./useMutation-Q6yEhfYM.js";import{C as N,b as q,d as A,e as P,a as f}from"./card-Ck-Z1Ioi.js";import{B as i}from"./button-cJjcAD9d.js";import{I as l}from"./input-DLMUXFSQ.js";import{L as n}from"./label-CyVxfSYH.js";import{T as B}from"./textarea-DixNolmW.js";import{D as H,b as U,c as V,d as J,e as W,f as X}from"./dialog-CM6ugvJB.js";import{l as Y,c as Z,u as _,d as ee,t as se}from"./queries-CaknH6WJ.js";import{P as T}from"./plus-DeJg0nJ7.js";import{L as g,S as te}from"./settings-BAZdX8oI.js";import{S as k}from"./square-pen-B_Njxa3a.js";import{S as ae}from"./shield-DTICywEm.js";import{U as G}from"./users-C3BdU3O1.js";import{C as E}from"./chevron-right-CCqzOlOj.js";import{C as ie}from"./calendar-jDKXpgky.js";import{T as re}from"./trash-2-Bj50Vj3Q.js";import"./useBaseQuery-BBplwDo0.js";import"./utils-CDN07tui.js";import"./index-B_jtOnfb.js";import"./index-DJ6iqbtG.js";import"./index-DGzlw-Oo.js";import"./x-nACMLnX-.js";const D={name:"",startDate:"",endDate:"",registrationOpenDate:"",registrationCloseDate:"",registrationFee:"75.00",description:""};function qe(){const d=K(),{data:y=[],isLoading:M}=$(Y.all()),[Q,c]=u.useState(!1),[o,p]=u.useState(null),[j,z]=u.useState(null),[t,r]=u.useState(D),C=h({mutationFn:async s=>await Z({data:{name:s.name,startDate:s.startDate,endDate:s.endDate,registrationOpenDate:s.registrationOpenDate,registrationCloseDate:s.registrationCloseDate,registrationFee:s.registrationFee,description:s.description||void 0}}),onSuccess:()=>{d.invalidateQueries({queryKey:["leagues"]}),x()}}),w=h({mutationFn:async({id:s,data:a})=>await _({data:{id:s,name:a.name,startDate:a.startDate,endDate:a.endDate,registrationOpenDate:a.registrationOpenDate,registrationCloseDate:a.registrationCloseDate,registrationFee:a.registrationFee,description:a.description||void 0}}),onSuccess:()=>{d.invalidateQueries({queryKey:["leagues"]}),x()}}),b=h({mutationFn:async s=>await ee({data:{id:s}}),onSuccess:()=>{d.invalidateQueries({queryKey:["leagues"]})}}),m=h({mutationFn:async s=>await se({data:{id:s}}),onSuccess:()=>{d.invalidateQueries({queryKey:["leagues"]})}}),x=()=>{c(!1),p(null),r(D)},F=s=>{p(s.id),r({name:s.name,startDate:s.startDate,endDate:s.endDate,registrationOpenDate:s.registrationOpenDate,registrationCloseDate:s.registrationCloseDate,registrationFee:s.registrationFee,description:s.description||""}),c(!0)},I=s=>{confirm("Are you sure you want to delete this league? This will also delete all associated teams.")&&b.mutate(s)},R=s=>{s.preventDefault(),o?w.mutate({id:o,data:t}):C.mutate(t)},L=y.filter(s=>s.isActive),S=y.filter(s=>!s.isActive),v=C.isPending||w.isPending;return M?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(O,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Leagues"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage leagues, divisions, and team assignments"})]}),e.jsxs(i,{onClick:()=>{c(!0),p(null),r(D)},children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Create League"]})]}),e.jsx(H,{open:Q,onOpenChange:s=>!s&&x(),children:e.jsxs(U,{className:"sm:max-w-[550px]",children:[e.jsxs(V,{children:[e.jsx(J,{children:o?"Edit League":"Create New League"}),e.jsx(W,{children:"Set up a new league for an upcoming season"})]}),e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"name",children:"League Name"}),e.jsx(l,{id:"name",value:t.name,onChange:s=>r({...t,name:s.target.value}),placeholder:"e.g., Spring 2026",required:!0})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"startDate",children:"Season Start"}),e.jsx(l,{id:"startDate",type:"date",value:t.startDate,onChange:s=>r({...t,startDate:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"endDate",children:"Season End"}),e.jsx(l,{id:"endDate",type:"date",value:t.endDate,onChange:s=>r({...t,endDate:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"registrationOpenDate",children:"Registration Opens"}),e.jsx(l,{id:"registrationOpenDate",type:"date",value:t.registrationOpenDate,onChange:s=>r({...t,registrationOpenDate:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"registrationCloseDate",children:"Registration Closes"}),e.jsx(l,{id:"registrationCloseDate",type:"date",value:t.registrationCloseDate,onChange:s=>r({...t,registrationCloseDate:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"registrationFee",children:"Registration Fee ($)"}),e.jsx(l,{id:"registrationFee",type:"number",step:"0.01",value:t.registrationFee,onChange:s=>r({...t,registrationFee:s.target.value}),placeholder:"75.00",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description (optional)"}),e.jsx(B,{id:"description",value:t.description,onChange:s=>r({...t,description:s.target.value}),placeholder:"League description...",rows:2})]}),e.jsxs(X,{children:[e.jsx(i,{type:"button",variant:"outline",onClick:x,disabled:v,children:"Cancel"}),e.jsxs(i,{type:"submit",disabled:v,children:[v&&e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Save Changes":"Create League"]})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),"Active Leagues"]}),L.length>0?e.jsx("div",{className:"space-y-4",children:L.map(s=>e.jsxs(N,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),s.name,e.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-green-100 text-green-700",children:"Active"})]}),e.jsxs(P,{className:"mt-1",children:[new Date(s.startDate).toLocaleDateString()," -"," ",new Date(s.endDate).toLocaleDateString()," • ","$",s.registrationFee," registration"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>F(s),children:e.jsx(k,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>m.mutate(s.id),disabled:m.isPending,children:e.jsx(te,{className:"h-4 w-4"})})]})]})}),e.jsxs(f,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground mb-1",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Age Groups"})]}),e.jsx("span",{className:"text-2xl font-bold",children:s.divisions.length})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground mb-1",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Teams"})]}),e.jsx("span",{className:"text-2xl font-bold",children:s.teamCount})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground mb-1",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Players"})]}),e.jsx("span",{className:"text-2xl font-bold",children:s.playerCount})]})]}),s.divisions.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h4",{className:"font-semibold",children:"Age Groups"})}),e.jsx("div",{className:"divide-y rounded-lg border",children:s.divisions.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-primary",children:a.ageGroup})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[a.ageGroup," Division"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.teamCount," teams"]})]})]}),e.jsxs(i,{variant:"ghost",size:"sm",children:["Manage Teams",e.jsx(E,{className:"ml-1 h-4 w-4"})]})]},a.ageGroup))})]}),s.divisions.length===0&&e.jsx("div",{className:"text-center py-4 text-muted-foreground border rounded-lg",children:"No teams registered yet"}),e.jsxs("div",{className:"flex gap-2 mt-6 pt-4 border-t",children:[e.jsxs(i,{variant:"outline",className:"flex-1",disabled:!0,children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Generate Schedule"]}),e.jsxs(i,{variant:"outline",className:"flex-1",disabled:!0,children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Team Assignments"]})]})]})]},s.id))}):e.jsx(N,{children:e.jsx(f,{className:"py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(g,{className:"mx-auto h-12 w-12 text-muted-foreground/50"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"No active leagues"}),e.jsxs(i,{variant:"outline",className:"mt-4",onClick:()=>c(!0),children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Create League"]})]})})})]}),S.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),"Past / Inactive Leagues"]}),e.jsx("div",{className:"space-y-4",children:S.map(s=>e.jsxs(N,{className:"opacity-75",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),s.name,e.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-700",children:"Inactive"})]}),e.jsxs(P,{className:"mt-1",children:[new Date(s.startDate).toLocaleDateString()," -"," ",new Date(s.endDate).toLocaleDateString()," • ",s.divisions.length," age groups • ",s.teamCount," teams •"," ",s.playerCount," players"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>m.mutate(s.id),disabled:m.isPending,children:"Activate"}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>F(s),children:e.jsx(k,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"icon",className:"text-destructive",onClick:()=>I(s.id),disabled:b.isPending,children:e.jsx(re,{className:"h-4 w-4"})})]})]})}),e.jsxs(f,{children:[e.jsxs(i,{variant:"ghost",className:"w-full justify-between",onClick:()=>z(j===s.id?null:s.id),children:["View Age Groups & Stats",e.jsx(E,{className:`h-4 w-4 transition-transform ${j===s.id?"rotate-90":""}`})]}),j===s.id&&e.jsx("div",{className:"mt-4 space-y-2",children:s.divisions.length>0?s.divisions.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted",children:[e.jsxs("span",{className:"font-medium",children:[a.ageGroup," Division"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.teamCount," teams"]})]},a.ageGroup)):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No teams were registered"})})]})]},s.id))})]})]})}export{qe as component};
