import{c as X,k as l,l as c,q as o,j as e,C as Z,x as R,n as ee,r}from"./main-Cj5NYhJq.js";import{u as x}from"./useQuery-Dpd-_BN-.js";import{u as se}from"./useMutation-Q6yEhfYM.js";import{C as g,b as y,d as b,e as ae,a as N}from"./card-Ck-Z1Ioi.js";import{B as d}from"./button-cJjcAD9d.js";import{I as k}from"./input-DLMUXFSQ.js";import{L as m}from"./label-CyVxfSYH.js";import{T as te}from"./textarea-DixNolmW.js";import{M as E}from"./mail-BfJGpDY6.js";import{M as P}from"./message-square-Dm0Wm1gW.js";import{U as L}from"./users-C3BdU3O1.js";import{S as ne}from"./shield-DTICywEm.js";import{C as ie}from"./calendar-jDKXpgky.js";import{C as U}from"./clock-C1xtiy3x.js";import{S as le}from"./send-DgH97LFa.js";import{F as ce}from"./file-text-Hyj7JkLp.js";import{C as re}from"./circle-check-big-mKp9k1mv.js";import{C as de}from"./circle-alert-B1uidcEr.js";import"./useBaseQuery-BBplwDo0.js";import"./utils-CDN07tui.js";import"./index-B_jtOnfb.js";const me=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],B=X("history",me),oe=l({method:"GET"}).handler(c("25b2d325487e75afc6c8c9d52a6b90a83aaa05dd53db728d57543235a14fa5f7")),ue=l({method:"GET"}).handler(c("85c847e7755e23e0fb3a6609fe82e948cc47d2aec89d83da38fb551a9340e955"));l({method:"POST"}).handler(c("8110a98f6513afc2c7c894aa0d23e22c6a8ec855b9bb469eb8341d5258781c7e"));l({method:"POST"}).handler(c("af8fc817dd7367384785c7f61fc7481d4e2e82de9663fefa1cb81e9455b173a7"));l({method:"POST"}).handler(c("737c7c55fecd0640a8124ad661b89b94f2d1a108204d1fd948449f95a91c8959"));const xe=l({method:"GET"}).handler(c("231383daeb247975f8957b85d49468e445eeeb297635d23572f350371f6cd17f")),he=l({method:"GET"}).handler(c("c494ba8f5415ed5e6397ce620841dc442a441ac5f19d5948f8c8fc4892e26cb9")),pe=l({method:"GET"}).handler(c("f5d49ed0576b53fbcbeadf679c768df367f7a7d879381b4917097434205465f7")),je=l({method:"POST"}).handler(c("970ff36921000af9073613a1bb0c68250004d2415cd3bae77230118c16e989c4")),fe=l({method:"GET"}).handler(c("5fb8e5b48badc2dfe28140c42ae7ef29fba46a47a9738d1a9ba110bf37f52017")),h={templates:()=>o({queryKey:["communications","templates"],queryFn:async({signal:a})=>await oe({signal:a}),staleTime:1e3*60*5}),activeTemplates:()=>o({queryKey:["communications","templates","active"],queryFn:async({signal:a})=>await ue({signal:a}),staleTime:1e3*60*5}),logs:()=>o({queryKey:["communications","logs"],queryFn:async({signal:a})=>await xe({signal:a}),staleTime:1e3*60}),teams:()=>o({queryKey:["communications","teams"],queryFn:async({signal:a})=>await he({signal:a}),staleTime:1e3*60*5}),seasons:()=>o({queryKey:["communications","seasons"],queryFn:async({signal:a})=>await pe({signal:a}),staleTime:1e3*60*5}),stats:()=>o({queryKey:["communications","stats"],queryFn:async({signal:a})=>await fe({signal:a}),staleTime:1e3*60})};function ge(a){const i=new Date(a),v=i.getMonth()+1,p=i.getDate(),S=i.getFullYear(),j=i.getHours(),T=i.getMinutes().toString().padStart(2,"0"),u=j>=12?"PM":"AM",t=j%12||12;return`${v}/${p}/${S}, ${t}:${T} ${u}`}function Qe(){return e.jsx(Z,{fallback:e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Communications"}),e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}),children:e.jsx(ye,{})})}function ye(){const a=ee(),{data:i=[],isLoading:v}=x(h.activeTemplates()),{data:p=[],isLoading:S}=x(h.logs()),{data:j=[]}=x(h.teams()),{data:T=[]}=x(h.seasons()),{data:u}=x(h.stats()),[t,A]=r.useState("email"),[n,f]=r.useState("all"),[$,H]=r.useState(""),[K,Y]=r.useState(""),[O,_]=r.useState(""),[G,z]=r.useState(""),[D,w]=r.useState(""),[C,M]=r.useState(""),[V,I]=r.useState(""),q=se({mutationFn:async()=>await je({data:{type:t,subject:t==="email"?D:void 0,body:C,recipientType:n,teamId:n==="team"?$:void 0,seasonId:n==="season"?K:void 0,recipientEmail:n==="individual"&&t==="email"?O:void 0,recipientPhone:n==="individual"&&t==="sms"?G:void 0}}),onSuccess:()=>{a.invalidateQueries({queryKey:["communications"]}),w(""),M(""),I(""),alert("Message sent successfully!")},onError:s=>{alert(`Failed to send message: ${s.message}`)}}),Q=s=>{const F=i.find(W=>W.id===s);F&&(I(s),w(F.subject),M(F.body))},J=s=>{s.preventDefault(),q.mutate()};return v||S?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Communications"}),e.jsx("p",{className:"text-muted-foreground",children:"Send emails and SMS messages to parents and teams"})]})}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs(g,{children:[e.jsxs(y,{children:[e.jsx(b,{children:"Compose Message"}),e.jsx(ae,{children:"Send email or SMS to parents, teams, or seasons"})]}),e.jsx(N,{children:e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Message Type"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{type:"button",variant:t==="email"?"default":"outline",onClick:()=>A("email"),children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Email"]}),e.jsxs(d,{type:"button",variant:t==="sms"?"default":"outline",onClick:()=>A("sms"),children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"SMS"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Recipients"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs(d,{type:"button",variant:n==="all"?"default":"outline",onClick:()=>f("all"),className:"justify-start",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"All Parents"]}),e.jsxs(d,{type:"button",variant:n==="team"?"default":"outline",onClick:()=>f("team"),className:"justify-start",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Team"]}),e.jsxs(d,{type:"button",variant:n==="season"?"default":"outline",onClick:()=>f("season"),className:"justify-start",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Season"]}),e.jsxs(d,{type:"button",variant:n==="individual"?"default":"outline",onClick:()=>f("individual"),className:"justify-start",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"Individual"]})]})]}),n==="team"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"team",children:"Select Team"}),e.jsxs("select",{id:"team",value:$,onChange:s=>H(s.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",required:!0,children:[e.jsx("option",{value:"",children:"Choose a team..."}),j.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),n==="season"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"season",children:"Select Season"}),e.jsxs("select",{id:"season",value:K,onChange:s=>Y(s.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",required:!0,children:[e.jsx("option",{value:"",children:"Choose a season..."}),T.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),n==="individual"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"recipient",children:t==="email"?"Recipient Email":"Recipient Phone"}),t==="email"?e.jsx(k,{id:"recipient",type:"email",value:O,onChange:s=>_(s.target.value),placeholder:"email@example.com",required:!0}):e.jsx(k,{id:"recipient",type:"tel",value:G,onChange:s=>z(s.target.value),placeholder:"+1 (555) 123-4567",required:!0})]}),i.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"template",children:"Use Template (Optional)"}),e.jsxs("select",{id:"template",value:V,onChange:s=>Q(s.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Select a template..."}),i.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),t==="email"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"subject",children:"Subject"}),e.jsx(k,{id:"subject",value:D,onChange:s=>w(s.target.value),placeholder:"Email subject",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"message",children:"Message"}),e.jsx(te,{id:"message",value:C,onChange:s=>M(s.target.value),placeholder:"Your message...",rows:6,required:!0}),t==="sms"&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[C.length,"/160 characters (standard SMS limit)"]})]}),e.jsxs("div",{className:"rounded-lg bg-muted p-4",children:[e.jsx("p",{className:"text-sm font-medium",children:"Available Variables:"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Use these in your message: ","{{team}}",", ","{{date}}",", ","{{time}}",", ","{{location}}",",","{{playerName}}",", ","{{reason}}"]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(d,{type:"button",variant:"outline",disabled:!0,children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Schedule"]}),e.jsxs(d,{type:"submit",disabled:q.isPending,children:[q.isPending?e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(le,{className:"mr-2 h-4 w-4"}),"Send Now"]})]})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(g,{children:[e.jsx(y,{children:e.jsx(b,{children:"Quick Stats"})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Emails Sent (This Month)"})]}),e.jsx("span",{className:"font-semibold",children:u?.emailsSentThisMonth??0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"SMS Sent (This Month)"})]}),e.jsx("span",{className:"font-semibold",children:u?.smsSentThisMonth??0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Total Recipients"})]}),e.jsx("span",{className:"font-semibold",children:u?.totalRecipientsThisMonth??0})]})]})]}),e.jsxs(g,{children:[e.jsx(y,{children:e.jsxs(b,{className:"flex items-center justify-between",children:["Templates",e.jsx(d,{variant:"ghost",size:"sm",children:e.jsx(ce,{className:"h-4 w-4"})})]})}),e.jsx(N,{children:i.length>0?e.jsx("div",{className:"space-y-2",children:i.map(s=>e.jsxs("button",{onClick:()=>Q(s.id),className:"w-full text-left rounded-lg border p-3 hover:bg-muted transition-colors",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"font-medium text-sm",children:s.name})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 truncate",children:s.body})]},s.id))}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No templates available"})})]})]})]}),e.jsxs(g,{children:[e.jsx(y,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"Recent Messages"]})}),e.jsx(N,{children:p.length>0?e.jsx("div",{className:"divide-y",children:p.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`rounded-full p-2 ${s.type==="email"?"bg-blue-100":"bg-green-100"}`,children:s.type==="email"?e.jsx(E,{className:"h-4 w-4 text-blue-600"}):e.jsx(P,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.subject||"SMS Message"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["To: ",s.recipientType==="all"?"All Parents":s.recipientType," (",s.recipientCount," recipients)"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:ge(s.sentAt)})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:s.status==="sent"?e.jsxs("span",{className:"flex items-center gap-1 text-green-600 text-sm",children:[e.jsx(re,{className:"h-4 w-4"}),"Sent"]}):s.status==="failed"?e.jsxs("span",{className:"flex items-center gap-1 text-red-600 text-sm",children:[e.jsx(de,{className:"h-4 w-4"}),"Failed"]}):e.jsxs("span",{className:"flex items-center gap-1 text-yellow-600 text-sm",children:[e.jsx(U,{className:"h-4 w-4"}),"Pending"]})})]},s.id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(B,{className:"mx-auto h-12 w-12 text-muted-foreground/50 mb-2"}),"No messages sent yet"]})})]})]})}export{Qe as component};
