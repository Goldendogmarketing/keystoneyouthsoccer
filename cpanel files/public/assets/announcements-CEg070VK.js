import{c as U,k as m,l as x,q as O,j as e,C as G,x as P,n as V,r as D}from"./main-Cj5NYhJq.js";import{u as W}from"./useQuery-Dpd-_BN-.js";import{u as g}from"./useMutation-Q6yEhfYM.js";import{C as A,b as T,d as S,e as F,a as q}from"./card-Ck-Z1Ioi.js";import{B as l}from"./button-cJjcAD9d.js";import{I as h}from"./input-DLMUXFSQ.js";import{L as r}from"./label-CyVxfSYH.js";import{T as Y}from"./textarea-DixNolmW.js";import{P as z}from"./plus-DeJg0nJ7.js";import{C as J}from"./circle-alert-B1uidcEr.js";import{C as X}from"./circle-check-big-mKp9k1mv.js";import{E as Q}from"./eye-CG1dm97g.js";import{S as K}from"./square-pen-B_Njxa3a.js";import{E as _}from"./eye-off-BVArP0Fi.js";import{T as B}from"./trash-2-Bj50Vj3Q.js";import{M as Z}from"./megaphone-DUGgyXVd.js";import"./useBaseQuery-BBplwDo0.js";import"./utils-CDN07tui.js";import"./index-B_jtOnfb.js";const ee=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],se=U("external-link",ee);const te=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ae=U("info",te);const ne=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ie=U("triangle-alert",ne),le=m({method:"GET"}).handler(x("5ae0504b1f20a6d8c83fc37023d9b4df2fad6381db7e380a0a0f977a20fdfa6c")),re=m({method:"GET"}).handler(x("2a15981de6334713ed9de94ff92967306e0939465883c278bfc7fdcc49133cfd")),ce=m({method:"POST"}).handler(x("ed65ee11f1d0fea88a69dbde34a54d774880807a07b36362f8c05e96b659e386")),de=m({method:"POST"}).handler(x("287ad6d3ac2abb977ed443bf8db1be2795311878e2fd34955ce25028bf323315")),oe=m({method:"POST"}).handler(x("9696c36524f79a45becc8bc1bd32e5d162e84c7ece20474e210ac2d161dec698")),me=m({method:"POST"}).handler(x("23f3a0aef6e925e16c13a3fa1f3eab6c858ce5d721361b798de3d4457ce1cb9e")),xe={all:()=>O({queryKey:["announcements"],queryFn:async({signal:n})=>await le({signal:n}),staleTime:1e3*60}),active:()=>O({queryKey:["announcements","active"],queryFn:async({signal:n})=>await re({signal:n}),staleTime:1e3*60*5})};function H(n){const c=new Date(n),j=c.getMonth()+1,f=c.getDate(),d=c.getFullYear();return`${j}/${f}/${d}`}const M={title:"",message:"",type:"info",linkUrl:"",linkText:"",startDate:"",endDate:""},o={info:{icon:ae,color:"text-blue-600",bgColor:"bg-blue-100",label:"Info"},warning:{icon:ie,color:"text-yellow-600",bgColor:"bg-yellow-100",label:"Warning"},success:{icon:X,color:"text-green-600",bgColor:"bg-green-100",label:"Success"},urgent:{icon:J,color:"text-red-600",bgColor:"bg-red-100",label:"Urgent"}};function Pe(){return e.jsx(G,{fallback:e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Announcements"}),e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(P,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}),children:e.jsx(he,{})})}function he(){const n=V(),{data:c=[],isLoading:j}=W(xe.all()),[f,d]=D.useState(!1),[u,v]=D.useState(null),[t,i]=D.useState(M),E=g({mutationFn:async s=>await ce({data:{title:s.title,message:s.message,type:s.type,linkUrl:s.linkUrl||void 0,linkText:s.linkText||void 0,startDate:s.startDate||void 0,endDate:s.endDate||void 0}}),onSuccess:()=>{n.invalidateQueries({queryKey:["announcements"]}),b()}}),I=g({mutationFn:async({id:s,data:a})=>await de({data:{id:s,title:a.title,message:a.message,type:a.type,linkUrl:a.linkUrl||void 0,linkText:a.linkText||void 0,startDate:a.startDate||void 0,endDate:a.endDate||void 0}}),onSuccess:()=>{n.invalidateQueries({queryKey:["announcements"]}),b()}}),y=g({mutationFn:async s=>await oe({data:{id:s}}),onSuccess:()=>{n.invalidateQueries({queryKey:["announcements"]})}}),p=g({mutationFn:async s=>await me({data:{id:s}}),onSuccess:()=>{n.invalidateQueries({queryKey:["announcements"]})}}),b=()=>{d(!1),v(null),i(M)},$=s=>{v(s.id),i({title:s.title,message:s.message,type:s.type,linkUrl:s.linkUrl||"",linkText:s.linkText||"",startDate:s.startDate?new Date(s.startDate).toISOString().split("T")[0]:"",endDate:s.endDate?new Date(s.endDate).toISOString().split("T")[0]:""}),d(!0)},L=s=>{confirm("Are you sure you want to delete this announcement?")&&y.mutate(s)},R=s=>{s.preventDefault(),u?I.mutate({id:u,data:t}):E.mutate(t)},N=c.filter(s=>s.isActive),k=c.filter(s=>!s.isActive),C=E.isPending||I.isPending;return j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(P,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Announcements"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage landing page announcements and alerts"})]}),e.jsxs(l,{onClick:()=>{d(!0),v(null),i(M)},children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"New Announcement"]})]}),f&&e.jsxs(A,{children:[e.jsxs(T,{children:[e.jsx(S,{children:u?"Edit Announcement":"Create Announcement"}),e.jsx(F,{children:"Announcements appear as banners on the website homepage"})]}),e.jsx(q,{children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"title",children:"Title"}),e.jsx(h,{id:"title",value:t.title,onChange:s=>i({...t,title:s.target.value}),placeholder:"Announcement title",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"type",children:"Type"}),e.jsx("select",{id:"type",value:t.type,onChange:s=>i({...t,type:s.target.value}),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:Object.entries(o).map(([s,a])=>e.jsx("option",{value:s,children:a.label},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"message",children:"Message"}),e.jsx(Y,{id:"message",value:t.message,onChange:s=>i({...t,message:s.target.value}),placeholder:"Announcement message",rows:3,required:!0})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"linkUrl",children:"Link URL (optional)"}),e.jsx(h,{id:"linkUrl",value:t.linkUrl,onChange:s=>i({...t,linkUrl:s.target.value}),placeholder:"/register or https://..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"linkText",children:"Link Text (optional)"}),e.jsx(h,{id:"linkText",value:t.linkText,onChange:s=>i({...t,linkText:s.target.value}),placeholder:"Learn More"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"startDate",children:"Start Date (optional)"}),e.jsx(h,{id:"startDate",type:"date",value:t.startDate,onChange:s=>i({...t,startDate:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"endDate",children:"End Date (optional)"}),e.jsx(h,{id:"endDate",type:"date",value:t.endDate,onChange:s=>i({...t,endDate:s.target.value})})]})]}),t.title&&t.message&&e.jsxs("div",{className:"rounded-lg border p-4",children:[e.jsx(r,{className:"text-sm text-muted-foreground",children:"Preview"}),e.jsx("div",{className:`mt-2 rounded-lg p-4 ${o[t.type].bgColor}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[(()=>{const s=o[t.type].icon;return e.jsx(s,{className:`h-5 w-5 ${o[t.type].color}`})})(),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:t.title}),e.jsx("p",{className:"text-sm mt-1",children:t.message}),t.linkUrl&&t.linkText&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-sm font-medium text-primary mt-2",children:[t.linkText,e.jsx(se,{className:"h-3 w-3"})]})]})]})})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(l,{type:"button",variant:"outline",onClick:b,disabled:C,children:"Cancel"}),e.jsxs(l,{type:"submit",disabled:C,children:[C&&e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),u?"Save Changes":"Create Announcement"]})]})]})})]}),e.jsxs(A,{children:[e.jsxs(T,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-green-600"}),"Active Announcements (",N.length,")"]}),e.jsx(F,{children:"Currently visible on the website"})]}),e.jsx(q,{children:N.length>0?e.jsx("div",{className:"space-y-4",children:N.map(s=>{const a=o[s.type],w=a.icon;return e.jsxs("div",{className:"flex items-start justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`rounded-full p-2 ${a.bgColor}`,children:e.jsx(w,{className:`h-5 w-5 ${a.color}`})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.message}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Type: ",a.label]}),s.startDate&&e.jsxs("span",{children:["From: ",H(s.startDate)]}),s.endDate&&e.jsxs("span",{children:["Until: ",H(s.endDate)]})]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>$(s),children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>p.mutate(s.id),disabled:p.isPending,children:e.jsx(_,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",className:"text-destructive",onClick:()=>L(s.id),disabled:y.isPending,children:e.jsx(B,{className:"h-4 w-4"})})]})]},s.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"mx-auto h-12 w-12 text-muted-foreground/50"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"No active announcements"}),e.jsxs(l,{variant:"outline",className:"mt-4",onClick:()=>d(!0),children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Create Announcement"]})]})})]}),k.length>0&&e.jsxs(A,{children:[e.jsxs(T,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5 text-muted-foreground"}),"Inactive Announcements (",k.length,")"]}),e.jsx(F,{children:"Hidden from the website"})]}),e.jsx(q,{children:e.jsx("div",{className:"space-y-4",children:k.map(s=>{const a=o[s.type],w=a.icon;return e.jsxs("div",{className:"flex items-start justify-between rounded-lg border border-dashed p-4 opacity-60",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`rounded-full p-2 ${a.bgColor}`,children:e.jsx(w,{className:`h-5 w-5 ${a.color}`})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.message})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>$(s),children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>p.mutate(s.id),disabled:p.isPending,children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",className:"text-destructive",onClick:()=>L(s.id),disabled:y.isPending,children:e.jsx(B,{className:"h-4 w-4"})})]})]},s.id)})})})]})]})}export{Pe as component};
