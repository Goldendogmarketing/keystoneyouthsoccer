import{c as Ne,k as b,l as T,o as D,s as d,_ as V,z as _,n as we,A as be,r as i,j as e,x as R}from"./main-Cj5NYhJq.js";import{u as U}from"./useQuery-Dpd-_BN-.js";import{u as L}from"./useMutation-Q6yEhfYM.js";import{C as g,a as y}from"./card-Ck-Z1Ioi.js";import{B as o}from"./button-cJjcAD9d.js";import{I as w}from"./input-DLMUXFSQ.js";import{L as c}from"./label-CyVxfSYH.js";import{T as Te}from"./textarea-DixNolmW.js";import{B as u}from"./badge-BpQfvpTv.js";import{D as se,b as ae,c as te,d as le,e as ne,f as de}from"./dialog-CM6ugvJB.js";import{S as x,b as p,c as j,d as f,e as n}from"./select-CFFWftmL.js";import{g as Ce}from"./get-all-teams-DzcaZ_x8.js";import{P as re}from"./plus-DeJg0nJ7.js";import{C as X}from"./calendar-jDKXpgky.js";import{C as ce}from"./clock-C1xtiy3x.js";import{C as Ie}from"./circle-check-big-mKp9k1mv.js";import{F as Ae}from"./funnel-CnwJxszZ.js";import{M as Fe}from"./map-pin-DNGYzB5p.js";import{T as Ge}from"./trophy-CYphMYWn.js";import{S as De}from"./square-pen-B_Njxa3a.js";import{T as ke}from"./trash-2-Bj50Vj3Q.js";import"./useBaseQuery-BBplwDo0.js";import"./utils-CDN07tui.js";import"./index-B_jtOnfb.js";import"./index-DJ6iqbtG.js";import"./index-DGzlw-Oo.js";import"./x-nACMLnX-.js";const Pe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],qe=Ne("circle-x",Pe),Be=b({method:"GET"}).handler(T("d127262fe30605b507707ab315c22964386e48315d66fdf846f5877e2752983a"));b({method:"GET"}).validator(D({seasonId:d().uuid()})).handler(T("44e6dec7bd934360898697b7ea6abdb4945b02ac37f37af9570e9cbf832e810f"));const Ee=b({method:"POST"}).validator(D({seasonId:d().uuid(),homeTeamId:d().uuid().optional(),awayTeamId:d().uuid().optional(),scheduledAt:d(),location:d().min(1),field:d().optional(),type:V(["regular","playoff","tournament"]).default("regular"),notes:d().optional()})).handler(T("cb3f2f87dc758d2edd735e6db3d5d6203bec710091f0976b3e4fcfa19502e0bb")),Le=b({method:"POST"}).validator(D({id:d().uuid(),homeTeamId:d().uuid().optional().nullable(),awayTeamId:d().uuid().optional().nullable(),scheduledAt:d().optional(),location:d().min(1).optional(),field:d().optional().nullable(),type:V(["regular","playoff","tournament"]).optional(),status:V(["scheduled","in_progress","completed","cancelled"]).optional(),homeScore:_().int().min(0).optional().nullable(),awayScore:_().int().min(0).optional().nullable(),notes:d().optional().nullable()})).handler(T("6f164556ea0eb95de9349fd13f53dd3cf0cf0b73b0efee06323e2e3944f6abe2")),Me=b({method:"POST"}).validator(D({id:d().uuid()})).handler(T("4d0dd3b55c37e2c19fd04f18d02e7d93f74c488492993379d71453764dc35cd2")),Ve=b({method:"POST"}).validator(D({id:d().uuid(),homeScore:_().int().min(0),awayScore:_().int().min(0),status:V(["scheduled","in_progress","completed","cancelled"]).default("completed")})).handler(T("f825f33c417f2f95f632fe4486ae3ceb1009ccb33180041b974a4aec9f5028ea")),M={seasonId:"",homeTeamId:"",awayTeamId:"",scheduledAt:"",scheduledTime:"10:00",location:"",field:"",type:"regular",notes:""};function xs(){const a=we(),{data:m=[],isLoading:K}=U({queryKey:["admin-games"],queryFn:async()=>await Be()}),{data:C=[]}=U({queryKey:["admin-teams"],queryFn:async()=>await Ce()}),{data:I}=U({queryKey:["seasons"],queryFn:async()=>await be()}),v=I?.seasons||[],[A,h]=i.useState(!1),[O,S]=i.useState(!1),[F,k]=i.useState(null),[P,Y]=i.useState(null),[t,r]=i.useState(M),[N,q]=i.useState({homeScore:"0",awayScore:"0"}),[z,ie]=i.useState("all"),[Q,oe]=i.useState("all"),[B,me]=i.useState("all"),J=L({mutationFn:async s=>{const l=`${s.scheduledAt}T${s.scheduledTime}:00`;return await Ee({data:{seasonId:s.seasonId,homeTeamId:s.homeTeamId||void 0,awayTeamId:s.awayTeamId||void 0,scheduledAt:l,location:s.location,field:s.field||void 0,type:s.type,notes:s.notes||void 0}})},onSuccess:()=>{a.invalidateQueries({queryKey:["admin-games"]}),E()}}),W=L({mutationFn:async({id:s,data:l})=>{const G=`${l.scheduledAt}T${l.scheduledTime}:00`;return await Le({data:{id:s,homeTeamId:l.homeTeamId||null,awayTeamId:l.awayTeamId||null,scheduledAt:G,location:l.location,field:l.field||null,type:l.type,notes:l.notes||null}})},onSuccess:()=>{a.invalidateQueries({queryKey:["admin-games"]}),E()}}),ue=L({mutationFn:async s=>await Me({data:{id:s}}),onSuccess:()=>{a.invalidateQueries({queryKey:["admin-games"]})}}),$=L({mutationFn:async({id:s,homeScore:l,awayScore:G})=>await Ve({data:{id:s,homeScore:l,awayScore:G,status:"completed"}}),onSuccess:()=>{a.invalidateQueries({queryKey:["admin-games"]}),S(!1),Y(null),q({homeScore:"0",awayScore:"0"})}}),E=()=>{h(!1),k(null),r(M)},he=s=>{const l=new Date(s.scheduledAt);k(s.id),r({seasonId:s.seasonId,homeTeamId:s.homeTeamId||"",awayTeamId:s.awayTeamId||"",scheduledAt:l.toISOString().split("T")[0],scheduledTime:l.toTimeString().slice(0,5),location:s.location,field:s.field||"",type:s.type,notes:s.notes||""}),h(!0)},xe=s=>{confirm("Are you sure you want to delete this game?")&&ue.mutate(s)},pe=s=>{Y(s.id),q({homeScore:String(s.homeScore||0),awayScore:String(s.awayScore||0)}),S(!0)},je=s=>{s.preventDefault(),F?W.mutate({id:F,data:t}):J.mutate(t)},fe=s=>{s.preventDefault(),P&&$.mutate({id:P,homeScore:parseInt(N.homeScore)||0,awayScore:parseInt(N.awayScore)||0})},Z=t.seasonId?C.filter(s=>s.seasonId===t.seasonId):C,ge=[...new Set(C.map(s=>s.ageGroup))].sort(),ee=m.filter(s=>{if(z!=="all"&&s.seasonId!==z||Q!=="all"&&s.status!==Q)return!1;if(B!=="all"){const l=s.homeTeam?.ageGroup,G=s.awayTeam?.ageGroup;if(l!==B&&G!==B)return!1}return!0}),H=J.isPending||W.isPending,ye=m.filter(s=>s.status==="scheduled").length,ve=m.filter(s=>s.status==="completed").length,Se=m.filter(s=>s.status==="cancelled").length;return K?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Game Schedule"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage games and record scores"})]}),e.jsxs(o,{onClick:()=>{h(!0),k(null),r(M)},children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Add Game"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsx(g,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Games"}),e.jsx("p",{className:"text-2xl font-bold",children:m.length})]}),e.jsx(X,{className:"h-8 w-8 text-primary/50"})]})})}),e.jsx(g,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheduled"}),e.jsx("p",{className:"text-2xl font-bold",children:ye})]}),e.jsx(ce,{className:"h-8 w-8 text-blue-500/50"})]})})}),e.jsx(g,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold",children:ve})]}),e.jsx(Ie,{className:"h-8 w-8 text-green-500/50"})]})})}),e.jsx(g,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cancelled"}),e.jsx("p",{className:"text-2xl font-bold",children:Se})]}),e.jsx(qe,{className:"h-8 w-8 text-red-500/50"})]})})})]}),e.jsx(g,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Filters:"})]}),e.jsxs(x,{value:z,onValueChange:ie,children:[e.jsx(p,{className:"w-[180px]",children:e.jsx(j,{placeholder:"All Seasons"})}),e.jsxs(f,{children:[e.jsx(n,{value:"all",children:"All Seasons"}),v.map(s=>e.jsx(n,{value:s.id,children:s.name},s.id))]})]}),e.jsxs(x,{value:B,onValueChange:me,children:[e.jsx(p,{className:"w-[150px]",children:e.jsx(j,{placeholder:"All Age Groups"})}),e.jsxs(f,{children:[e.jsx(n,{value:"all",children:"All Age Groups"}),ge.map(s=>e.jsx(n,{value:s,children:s},s))]})]}),e.jsxs(x,{value:Q,onValueChange:oe,children:[e.jsx(p,{className:"w-[150px]",children:e.jsx(j,{placeholder:"All Status"})}),e.jsxs(f,{children:[e.jsx(n,{value:"all",children:"All Status"}),e.jsx(n,{value:"scheduled",children:"Scheduled"}),e.jsx(n,{value:"in_progress",children:"In Progress"}),e.jsx(n,{value:"completed",children:"Completed"}),e.jsx(n,{value:"cancelled",children:"Cancelled"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:ee.length>0?ee.map(s=>e.jsx(_e,{game:s,onEdit:he,onDelete:xe,onScore:pe},s.id)):e.jsx(g,{children:e.jsxs(y,{className:"py-12 text-center",children:[e.jsx(X,{className:"mx-auto h-12 w-12 text-muted-foreground/50"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"No games found"}),e.jsxs(o,{variant:"outline",className:"mt-4",onClick:()=>{h(!0),k(null),r(M)},children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Add Your First Game"]})]})})}),e.jsx(se,{open:A,onOpenChange:s=>!s&&E(),children:e.jsxs(ae,{className:"sm:max-w-[600px]",children:[e.jsxs(te,{children:[e.jsx(le,{children:F?"Edit Game":"Add New Game"}),e.jsx(ne,{children:F?"Update game details":"Schedule a new game between two teams"})]}),e.jsxs("form",{onSubmit:je,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"seasonId",children:"Season *"}),e.jsxs(x,{value:t.seasonId,onValueChange:s=>r({...t,seasonId:s,homeTeamId:"",awayTeamId:""}),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select season"})}),e.jsx(f,{children:v.map(s=>e.jsx(n,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"homeTeamId",children:"Home Team"}),e.jsxs(x,{value:t.homeTeamId,onValueChange:s=>r({...t,homeTeamId:s}),disabled:!t.seasonId,children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select home team"})}),e.jsxs(f,{children:[e.jsx(n,{value:"",children:"TBD"}),Z.map(s=>e.jsxs(n,{value:s.id,children:[s.name," (",s.ageGroup,")"]},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"awayTeamId",children:"Away Team"}),e.jsxs(x,{value:t.awayTeamId,onValueChange:s=>r({...t,awayTeamId:s}),disabled:!t.seasonId,children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select away team"})}),e.jsxs(f,{children:[e.jsx(n,{value:"",children:"TBD"}),Z.map(s=>e.jsxs(n,{value:s.id,children:[s.name," (",s.ageGroup,")"]},s.id))]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"scheduledAt",children:"Date *"}),e.jsx(w,{id:"scheduledAt",type:"date",value:t.scheduledAt,onChange:s=>r({...t,scheduledAt:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"scheduledTime",children:"Time *"}),e.jsx(w,{id:"scheduledTime",type:"time",value:t.scheduledTime,onChange:s=>r({...t,scheduledTime:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"location",children:"Location *"}),e.jsx(w,{id:"location",value:t.location,onChange:s=>r({...t,location:s.target.value}),placeholder:"e.g., Main Soccer Complex",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"field",children:"Field"}),e.jsx(w,{id:"field",value:t.field,onChange:s=>r({...t,field:s.target.value}),placeholder:"e.g., Field A"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"type",children:"Game Type"}),e.jsxs(x,{value:t.type,onValueChange:s=>r({...t,type:s}),children:[e.jsx(p,{children:e.jsx(j,{placeholder:"Select type"})}),e.jsxs(f,{children:[e.jsx(n,{value:"regular",children:"Regular Season"}),e.jsx(n,{value:"playoff",children:"Playoff"}),e.jsx(n,{value:"tournament",children:"Tournament"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"notes",children:"Notes"}),e.jsx(Te,{id:"notes",value:t.notes,onChange:s=>r({...t,notes:s.target.value}),placeholder:"Additional notes...",rows:2})]}),e.jsxs(de,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:E,disabled:H,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:H||!t.seasonId,children:[H&&e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),F?"Save Changes":"Add Game"]})]})]})]})}),e.jsx(se,{open:O,onOpenChange:s=>!s&&S(!1),children:e.jsxs(ae,{className:"sm:max-w-[400px]",children:[e.jsxs(te,{children:[e.jsx(le,{children:"Record Game Score"}),e.jsx(ne,{children:"Enter the final score for this game"})]}),e.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[P&&(()=>{const s=m.find(l=>l.id===P);return s?e.jsxs("div",{className:"text-center py-2 text-muted-foreground",children:[s.homeTeam?.name||"TBD"," vs ",s.awayTeam?.name||"TBD"]}):null})(),e.jsxs("div",{className:"grid gap-4 grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"homeScore",children:"Home Score"}),e.jsx(w,{id:"homeScore",type:"number",min:"0",value:N.homeScore,onChange:s=>q({...N,homeScore:s.target.value}),className:"text-center text-2xl font-bold h-14"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"awayScore",children:"Away Score"}),e.jsx(w,{id:"awayScore",type:"number",min:"0",value:N.awayScore,onChange:s=>q({...N,awayScore:s.target.value}),className:"text-center text-2xl font-bold h-14"})]})]}),e.jsxs(de,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>S(!1),children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:$.isPending,children:[$.isPending&&e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Score"]})]})]})]})})]})}function _e({game:a,onEdit:m,onDelete:K,onScore:C}){const I=new Date(a.scheduledAt),v=a.status==="completed",A=a.status==="cancelled",h=I<new Date&&!v&&!A,O=()=>{switch(a.status){case"completed":return e.jsx(u,{className:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",children:"Completed"});case"in_progress":return e.jsx(u,{className:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",children:"In Progress"});case"cancelled":return e.jsx(u,{className:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",children:"Cancelled"});default:return h?e.jsx(u,{className:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",children:"Needs Score"}):e.jsx(u,{variant:"outline",children:"Scheduled"})}},S=()=>{switch(a.type){case"playoff":return e.jsx(u,{variant:"secondary",children:"Playoff"});case"tournament":return e.jsx(u,{variant:"secondary",children:"Tournament"});default:return null}};return e.jsx(g,{className:A?"opacity-60":"",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[O(),S(),a.homeTeam?.ageGroup&&e.jsx(u,{variant:"outline",children:a.homeTeam.ageGroup})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center min-w-[120px]",children:[e.jsx("p",{className:"font-semibold",children:a.homeTeam?.name||"TBD"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Home"}),v&&e.jsx("p",{className:"text-3xl font-bold mt-1",children:a.homeScore})]}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-xl font-bold text-muted-foreground",children:"vs"})}),e.jsxs("div",{className:"text-center min-w-[120px]",children:[e.jsx("p",{className:"font-semibold",children:a.awayTeam?.name||"TBD"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Away"}),v&&e.jsx("p",{className:"text-3xl font-bold mt-1",children:a.awayScore})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-muted-foreground md:text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 md:justify-end",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{children:I.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-2 md:justify-end",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:I.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center gap-2 md:justify-end",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsxs("span",{children:[a.location,a.field?` - ${a.field}`:""]})]}),a.season&&e.jsx("div",{className:"text-xs mt-1",children:e.jsx("span",{className:"text-muted-foreground/70",children:a.season.name})})]}),e.jsxs("div",{className:"flex gap-2 md:flex-col",children:[(a.status==="scheduled"||h)&&!A&&e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>C(a),children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"}),"Score"]}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>m(a),children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx(o,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>K(a.id),children:e.jsx(ke,{className:"h-4 w-4"})})]})]})})})}export{xs as component};
